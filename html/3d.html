<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<style type="text/css">
			* {
				margin: 0;
				overflow: hidden;
			}

			canvas {
				image-rendering: pixelated;
				background-color: #000;
			}
		</style>
	</head>
	<body>
		<script id="spaceship" type="text/plain">
# Blender v2.79 (sub 0) OBJ File: 'spaceship.blend'
# www.blender.org
v 0.750000 -0.500000 0.050000
v 0.750000 0.300000 0.050000
v 2.500000 -0.300000 -0.550000
v 2.500000 -0.150000 -0.550000
v 2.600000 -0.400000 -1.150000
v 2.600000 0.200000 -1.150000
v 2.350000 -0.500000 -1.150000
v 2.350000 0.100000 -1.150000
v 2.320000 -0.300000 -0.690000
v 2.320000 -0.150000 -0.690000
v 0.400000 -0.350000 -0.350000
v 0.400000 0.250000 -0.350000
v 0.750000 -0.450000 -1.350000
v 0.750000 0.200000 -1.350000
v 0.600000 0.100000 -1.350000
v 0.600000 -0.300000 -1.350000
v 0.400000 0.000000 -1.050000
v 0.400000 -0.200000 -1.050000
v 1.000000 -0.220000 -0.150000
v 1.000000 0.070000 -0.150000
v 1.000000 -0.300000 -0.400000
v 1.000000 0.050000 -0.400000
v 0.000000 0.000000 3.050000
v 0.000000 -0.300000 0.550000
v 0.000000 0.650000 0.500000
v -0.750000 -0.500000 0.050000
v -0.750000 0.300000 0.050000
v -2.500000 -0.300000 -0.550000
v -2.500000 -0.150000 -0.550000
v -2.600000 -0.400000 -1.150000
v -2.600000 0.200000 -1.150000
v -2.350000 -0.500000 -1.150000
v -2.350000 0.100000 -1.150000
v -2.320000 -0.300000 -0.690000
v -2.320000 -0.150000 -0.690000
v -0.400000 -0.350000 -0.350000
v -0.400000 0.250000 -0.350000
v -0.750000 -0.450000 -1.350000
v -0.750000 0.200000 -1.350000
v 0.000000 0.400000 -0.350000
v 0.000000 0.550000 -1.350000
v 0.000000 -0.650000 -1.350000
v 0.000000 -0.250000 -0.350000
v -0.600000 0.100000 -1.350000
v -0.600000 -0.300000 -1.350000
v 0.000000 0.400000 -1.350000
v 0.000000 -0.500000 -1.350000
v -0.400000 0.000000 -1.050000
v -0.400000 -0.200000 -1.050000
v 0.000000 0.200000 -1.200000
v 0.000000 -0.300000 -1.200000
v -1.000000 -0.220000 -0.150000
v -1.000000 0.070000 -0.150000
v -1.000000 -0.300000 -0.400000
v -1.000000 0.050000 -0.400000
vt 0.033333 0.550000
vt 0.300000 0.950000
vt 0.033333 0.950000
vt 0.033333 0.550000
vt 0.300000 0.550000
vt 0.300000 0.950000
vt 0.300000 0.550000
vt 0.300000 0.950000
vt 0.033333 0.049554
vt 0.300000 0.049554
vt 0.300000 0.449554
vt 0.633333 0.750000
vt 0.366667 0.950000
vt 0.366667 0.750000
vt 0.633333 0.050000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.633333 0.050000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.366667 0.250000
vt 0.633333 0.450000
vt 0.366667 0.450000
vt 0.300000 0.049554
vt 0.033333 0.449554
vt 0.033333 0.049554
vt 0.366667 0.250000
vt 0.633333 0.450000
vt 0.366667 0.450000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.366667 0.750000
vt 0.633333 0.950000
vt 0.366667 0.950000
vt 0.700000 0.050000
vt 0.966667 0.050000
vt 0.966667 0.450000
vt 0.033333 0.550000
vt 0.300000 0.550000
vt 0.300000 0.950000
vt 0.033333 0.049554
vt 0.300000 0.049554
vt 0.300000 0.449554
vt 0.033333 0.045986
vt 0.300000 0.045986
vt 0.300000 0.445986
vt 0.300000 0.049554
vt 0.033333 0.449554
vt 0.033333 0.049554
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.700000 0.050000
vt 0.966667 0.050000
vt 0.966667 0.450000
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.033333 0.449554
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.033333 0.449554
vt 0.700000 0.050000
vt 0.966667 0.450000
vt 0.700000 0.450000
vt 0.966667 0.050000
vt 0.700000 0.450000
vt 0.700000 0.050000
vt 0.966667 0.050000
vt 0.700000 0.450000
vt 0.700000 0.050000
vt 0.966667 0.550000
vt 0.700000 0.950000
vt 0.700000 0.550000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.633333 0.450000
vt 0.366667 0.050000
vt 0.633333 0.250000
vt 0.366667 0.250000
vt 0.633333 0.550000
vt 0.366667 0.550000
vt 0.366667 0.550000
vt 0.633333 0.750000
vt 0.366667 0.750000
vt 0.366667 0.050000
vt 0.633333 0.250000
vt 0.033333 0.550000
vt 0.300000 0.550000
vt 0.300000 0.950000
vt 0.300000 0.950000
vt 0.300000 0.550000
vt 0.300000 0.550000
vt 0.300000 0.550000
vt 0.033333 0.049554
vt 0.300000 0.049554
vt 0.366667 0.950000
vt 0.633333 0.750000
vt 0.366667 0.750000
vt 0.366667 0.450000
vt 0.633333 0.050000
vt 0.366667 0.050000
vt 0.366667 0.450000
vt 0.633333 0.050000
vt 0.366667 0.050000
vt 0.366667 0.250000
vt 0.633333 0.450000
vt 0.633333 0.250000
vt 0.033333 0.449554
vt 0.300000 0.049554
vt 0.033333 0.049554
vt 0.366667 0.250000
vt 0.633333 0.450000
vt 0.633333 0.250000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.366667 0.750000
vt 0.633333 0.950000
vt 0.633333 0.750000
vt 0.966667 0.450000
vt 0.033333 0.550000
vt 0.300000 0.550000
vt 0.300000 0.049554
vt 0.033333 0.045986
vt 0.300000 0.445986
vt 0.033333 0.449554
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.700000 0.050000
vt 0.300000 0.449554
vt 0.033333 0.049554
vt 0.300000 0.449554
vt 0.300000 0.049554
vt 0.300000 0.449554
vt 0.300000 0.049554
vt 0.700000 0.050000
vt 0.966667 0.050000
vt 0.966667 0.050000
vt 0.700000 0.450000
vt 0.966667 0.050000
vt 0.700000 0.050000
vt 0.700000 0.950000
vt 0.700000 0.550000
vt 0.366667 0.450000
vt 0.366667 0.050000
vt 0.633333 0.450000
vt 0.633333 0.050000
vt 0.366667 0.050000
vt 0.633333 0.050000
vt 0.633333 0.550000
vt 0.366667 0.550000
vt 0.366667 0.550000
vt 0.633333 0.550000
vt 0.366667 0.050000
vt 0.633333 0.250000
vt 0.633333 0.050000
vt 0.033333 0.550000
vt 0.300000 0.950000
vt 0.633333 0.950000
vt 0.633333 0.450000
vt 0.633333 0.450000
vt 0.300000 0.449554
vt 0.633333 0.250000
vt 0.633333 0.450000
vt 0.300000 0.449554
vt 0.300000 0.049554
vt 0.300000 0.049554
vt 0.966667 0.450000
vt 0.966667 0.450000
vt 0.966667 0.950000
vt 0.633333 0.450000
vt 0.633333 0.050000
vt 0.633333 0.050000
vt 0.633333 0.750000
vt 0.633333 0.550000
vt 0.633333 0.050000
vt 0.033333 0.950000
vt 0.633333 0.950000
vt 0.633333 0.450000
vt 0.633333 0.450000
vt 0.366667 0.450000
vt 0.300000 0.449554
vt 0.366667 0.450000
vt 0.633333 0.450000
vt 0.366667 0.950000
vt 0.033333 0.449554
vt 0.700000 0.450000
vt 0.966667 0.450000
vt 0.966667 0.450000
vt 0.633333 0.450000
vt 0.366667 0.250000
vt 0.633333 0.750000
vt 0.366667 0.750000
vn -0.5547 0.0000 -0.8321
vn 0.5148 0.8308 0.2118
vn -0.1822 -0.9763 0.1172
vn 0.9701 0.0000 0.2425
vn 0.2577 0.0000 0.9662
vn 0.0000 0.0000 -1.0000
vn -0.3348 0.8369 0.4330
vn -0.0830 0.0000 -0.9965
vn 0.9439 0.0000 0.3304
vn 0.3897 0.8079 -0.4420
vn 0.9864 0.0000 0.1644
vn -0.0396 -0.9979 0.0510
vn 0.3385 0.9027 -0.2655
vn 0.4207 0.9014 0.1022
vn 0.3477 0.9272 0.1391
vn 0.2356 0.9174 -0.3208
vn -0.3091 -0.9472 -0.0848
vn -0.2422 -0.9687 -0.0538
vn -0.2261 -0.9044 0.3618
vn -0.0925 0.9245 -0.3698
vn -0.2873 -0.5747 -0.7663
vn -0.8321 0.0000 -0.5547
vn 0.3511 0.0000 -0.9363
vn 0.3414 -0.8536 0.3934
vn -0.9979 0.0000 -0.0651
vn 0.7950 -0.5778 0.1849
vn 0.1075 0.9845 -0.1383
vn -0.2146 0.0000 -0.9767
vn 0.6247 0.0000 0.7809
vn 0.2533 -0.9498 0.1836
vn 0.5292 -0.0446 -0.8473
vn -0.5148 0.8308 0.2118
vn 0.1822 -0.9763 0.1172
vn -0.9701 0.0000 0.2425
vn -0.2577 0.0000 0.9662
vn 0.3348 0.8369 0.4330
vn 0.0830 0.0000 -0.9965
vn -0.9439 0.0000 0.3304
vn -0.3096 0.9478 -0.0758
vn -0.9864 0.0000 0.1644
vn -0.0668 -0.9503 0.3041
vn -0.3385 0.9027 -0.2655
vn -0.4207 0.9014 0.1022
vn -0.3477 0.9272 0.1391
vn -0.2356 0.9174 -0.3208
vn 0.3091 -0.9472 -0.0848
vn 0.2422 -0.9687 -0.0538
vn 0.2261 -0.9044 0.3618
vn 0.1961 0.5883 -0.7845
vn 0.2873 -0.5747 -0.7663
vn 0.8321 0.0000 -0.5547
vn -0.3511 0.0000 -0.9363
vn -0.3414 -0.8536 0.3934
vn 0.9979 0.0000 -0.0651
vn -0.0448 -0.9219 -0.3849
vn -0.1075 0.9845 -0.1383
vn 0.2146 0.0000 -0.9767
vn -0.6247 0.0000 0.7809
vn -0.2533 -0.9498 0.1836
vn -0.5292 -0.0446 -0.8473
vn -0.3361 0.8368 0.4321
vn 0.3096 0.9478 -0.0758
vn 0.0668 -0.9503 0.3041
vn -0.1961 0.5883 -0.7845
vn -0.2559 -0.8530 -0.4549
vn -0.1128 -0.9830 0.1450
vn 0.0448 -0.9219 -0.3849
vn 0.1323 0.9880 -0.0790
vn 0.5547 0.0000 -0.8321
vn 0.3361 0.8368 0.4321
vn -0.3897 0.8079 -0.4420
vn 0.0396 -0.9979 0.0510
vn 0.0925 0.9245 -0.3698
vn 0.2559 -0.8530 -0.4549
vn 0.1128 -0.9830 0.1450
vn -0.7950 -0.5778 0.1849
vn -0.1323 0.9880 -0.0790
s off
f 24/1/1 2/2/1 1/3/1
f 23/4/2 2/5/2 25/6/2
f 24/1/3 1/7/3 23/8/3
f 1/9/4 2/10/4 23/11/4
f 19/12/5 4/13/5 20/14/5
f 5/15/6 8/16/6 6/17/6
f 10/18/7 6/19/7 8/20/7
f 22/21/8 11/22/8 12/23/8
f 11/24/9 14/25/9 12/26/9
f 20/27/10 12/28/10 2/29/10
f 5/15/11 4/30/11 3/31/11
f 19/32/12 9/33/12 3/34/12
f 40/35/13 25/36/13 12/37/13
f 12/38/14 14/39/14 41/40/14
f 40/41/15 12/42/15 41/43/15
f 12/44/16 25/45/16 2/46/16
f 42/47/6 16/48/6 13/49/6
f 24/50/17 11/24/17 1/51/17
f 11/52/18 24/53/18 43/54/18
f 43/55/19 42/47/19 11/56/19
f 14/57/6 16/58/6 15/59/6
f 41/60/6 15/61/6 46/62/6
f 16/63/20 51/64/20 18/65/20
f 15/66/21 50/67/21 46/68/21
f 16/69/22 17/70/22 15/71/22
f 51/72/23 17/73/23 18/74/23
f 5/15/24 9/75/24 7/76/24
f 7/76/25 10/77/25 8/16/25
f 1/78/26 21/79/26 19/80/26
f 10/81/27 20/14/27 4/82/27
f 10/83/28 21/84/28 22/85/28
f 2/86/29 19/87/29 20/27/29
f 11/88/30 42/89/30 13/90/30
f 24/1/31 27/91/31 25/92/31
f 23/4/32 25/6/32 27/93/32
f 24/1/33 23/8/33 26/94/33
f 26/95/34 23/11/34 27/96/34
f 29/97/35 52/98/35 53/99/35
f 33/100/6 30/101/6 31/102/6
f 31/103/36 35/104/36 33/105/36
f 55/106/37 36/107/37 54/108/37
f 39/109/38 36/110/38 37/111/38
f 53/112/39 37/113/39 55/114/39
f 29/115/40 30/101/40 28/116/40
f 52/117/41 34/118/41 54/119/41
f 40/35/42 37/120/42 25/36/42
f 37/121/43 41/40/43 39/122/43
f 40/41/44 41/43/44 37/123/44
f 37/124/45 27/125/45 25/45/45
f 45/126/6 42/47/6 38/127/6
f 24/50/46 26/128/46 36/110/46
f 36/129/47 43/54/47 24/53/47
f 43/55/48 36/130/48 42/47/48
f 39/131/6 45/132/6 38/133/6
f 41/60/6 44/134/6 39/135/6
f 45/136/49 51/64/49 47/137/49
f 50/67/50 44/138/50 46/68/50
f 48/139/51 45/140/51 44/141/51
f 48/142/52 51/72/52 49/143/52
f 34/144/53 30/101/53 32/145/53
f 32/145/54 35/146/54 34/147/54
f 26/148/55 54/108/55 36/149/55
f 53/99/56 35/150/56 29/151/56
f 35/152/57 54/119/57 34/153/57
f 27/154/58 52/155/58 26/156/58
f 36/157/59 38/158/59 42/89/59
f 24/1/60 25/92/60 2/2/60
f 19/12/5 3/159/5 4/13/5
f 5/15/6 7/160/6 8/16/6
f 10/18/61 4/161/61 6/19/61
f 22/21/8 21/79/8 11/22/8
f 11/24/9 13/162/9 14/25/9
f 20/27/62 22/163/62 12/28/62
f 5/15/11 6/164/11 4/30/11
f 19/32/63 21/84/63 9/33/63
f 42/47/6 47/165/6 16/48/6
f 14/57/6 13/166/6 16/58/6
f 41/60/6 14/167/6 15/61/6
f 16/63/64 47/137/64 51/64/64
f 15/66/65 17/168/65 50/67/65
f 16/69/22 18/169/22 17/70/22
f 51/72/23 50/170/23 17/73/23
f 5/15/66 3/171/66 9/75/66
f 7/76/25 9/172/25 10/77/25
f 1/78/67 11/173/67 21/79/67
f 10/81/68 22/174/68 20/14/68
f 10/83/28 9/175/28 21/84/28
f 2/86/29 1/176/29 19/87/29
f 24/1/69 26/177/69 27/91/69
f 29/97/35 28/178/35 52/98/35
f 33/100/6 32/179/6 30/101/6
f 31/103/70 29/180/70 35/104/70
f 55/106/37 37/181/37 36/107/37
f 39/109/38 38/182/38 36/110/38
f 53/112/71 27/183/71 37/113/71
f 29/115/40 31/184/40 30/101/40
f 52/117/72 28/185/72 34/118/72
f 45/126/6 47/165/6 42/47/6
f 39/131/6 44/186/6 45/132/6
f 41/60/6 46/62/6 44/134/6
f 45/136/73 49/187/73 51/64/73
f 50/67/74 48/188/74 44/138/74
f 48/139/51 49/189/51 45/140/51
f 48/142/52 50/170/52 51/72/52
f 34/144/75 28/190/75 30/101/75
f 32/145/54 33/100/54 35/146/54
f 26/148/76 52/191/76 54/108/76
f 53/99/77 55/192/77 35/150/77
f 35/152/57 55/193/57 54/119/57
f 27/154/58 53/112/58 52/155/58
		</script>
		<script type="text/javascript">
			
			var Game = function(args) {
				args = args || {};
				args.element = args.element || document.body;

				// variables
				this.canvas = document.createElement("canvas");
				this.canvas.tabIndex = 1;
				this.ctx = this.canvas.getContext("2d");
				this.image = null;
				this.keys = {
					w:0,a:0,s:0,d:0,
					q:0,e:0,r:0,f:0
				};

				this.camera = {
					position: [0,-0.5,1],
					rotation: [0,-0.2],
					speed: {
						position: 0.02,
						rotation: 0.004,
					}
				}

				this.renderQueue = [];

				this.fov = 90;
				this.clipping = [0, 100];

				// ortho
				this.scale = 64;

				// other functions
				this.obj = function(obj, size) {
					let verts = [];
					let faces = [];

					let lines = obj.split("\n");
					for (var i = 0; i < lines.length; i++) {
						let line = lines[i].split(" ");

						switch (line[0]) {
							case "v":
								verts.push([
									line[1]*size, line[2]*size, line[3]*size
								]);
								break;
							case "f":
								let face = [
									parseInt(line[1].split("/")[0]).toFixed(3)-1,
									parseInt(line[2].split("/")[0]).toFixed(3)-1,
									parseInt(line[3].split("/")[0]).toFixed(3)-1
								];

								faces.push([face[0], face[1], face[2]]);
								break;
						}
					}

					return {verts, faces};
				}


				this.rotate = function(p, r) {
					return [
						p[0]*Math.cos(r) - p[1]*Math.sin(r),
						p[1]*Math.cos(r) + p[0]*Math.sin(r)
					]
				}

				this.project = function(v) {
					z = v[2] // near
					if (z < 0) return undefined;

					f = (this.canvas.height/2)/z

					return [
						this.canvas.width/2+v[0]*f,
						this.canvas.height/2+v[1]*f
					]
				}

				this.plane = function(p, s) {
					hs = s/2;
					let verts = [
						[ p[0]-hs, p[1], p[2]-hs ],
						[ p[0]+hs, p[1], p[2]-hs ],
						[ p[0]-hs, p[1], p[2]+hs ],
						[ p[0]+hs, p[1], p[2]+hs ],
					]

					let faces = [
						[0, 1, 2], [1, 2, 3]
					]

					return {verts, faces}
				}

				// 2d functions
				this.drawPixel = function(p, color) {
					p[0] = Math.round(p[0]);
					p[1] = Math.round(p[1]);

					if (p[0]<0 || p[0]>this.canvas.width) return;
					if (p[1]<0 || p[1]>this.canvas.height) return;

					let i = 
						this.canvas.width*this.canvas.height*4 -
						(p[0]+(p[1]*this.canvas.width))*4;

					this.image.data[i] = color[0];
					this.image.data[i+1] = color[1];
					this.image.data[i+2] = color[2];
					this.image.data[i+3] = 255;
				}

				this.drawLine = function(p1, p2, color) {
					let pyth = Math.sqrt(p1*p1+p2*p2);
					let distance = [
						p2[0]-p1[0],
						p2[1]-p1[1]
					];

					for (let d=0; d<1; d+=0.01) {
						this.drawPixel([
							p1[0] + distance[0]*d,
							p1[1] + distance[1]*d
						], color);
					}
				}

				this.drawTri = function(p, color) {
					minX = Math.min(p[0][0],p[1][0],p[2][0]);
					maxX = Math.max(p[0][0],p[1][0],p[2][0]);
					minY = Math.min(p[0][1],p[1][1],p[2][1]);
					maxY = Math.max(p[0][1],p[1][1],p[2][1]);

					for (var y=minY; y<maxY; y++) {
						for (var x=minX; x<maxX; x++) {
							this.drawPixel([x,y], color);
						}
					}
				}

				// main game functions
				this.draw = function() {
					this.image = this.ctx.createImageData(this.canvas.width, this.canvas.height);

					for (var i=0; i<this.renderQueue.length; i++) {
						let points = []; 

						for (var v=0; v<this.renderQueue[i].verts.length; v++) {
							vertex = [
								this.renderQueue[i].verts[v][0]+this.camera.position[0],
								this.renderQueue[i].verts[v][1]+this.camera.position[1],
								this.renderQueue[i].verts[v][2]+this.camera.position[2],
							];

							yaw = this.rotate([vertex[0], vertex[2]], this.camera.rotation[0]);
							vertex[0] = yaw[0];
							vertex[2] = yaw[1];

							pitch = this.rotate([vertex[1], vertex[2]], this.camera.rotation[1]);
							vertex[1] = pitch[0];
							vertex[2] = pitch[1];

							points[v] = this.project(vertex);
						}

						for (var e=0; e<this.renderQueue[i].faces.length; e++) {
							p1 = points[this.renderQueue[i].faces[e][0]];
							p2 = points[this.renderQueue[i].faces[e][1]];
							p3 = points[this.renderQueue[i].faces[e][2]];
							if (p1 && p2 && p3) {
								this.drawLine(p1, p2,  [255,255,255]);
								this.drawLine(p2, p3,  [255,255,255]);
								this.drawLine(p3, p1,  [255,255,255]);
								//this.drawTri([p1, p2, p3], [255,255, 255]);
							}
						}
					}

					// this.drawTri([
					// 	[200, 100],
					// 	[100, 200],
					// 	[300, 200],
					// ], [255, 0, 0])

					this.ctx.putImageData(this.image, 0, 0);
				}

				this.update = function() {
					move = [0,0];
					if (this.keys.w) move[0] -= 1; if (this.keys.s) move[0] += 1;
					if (this.keys.a) move[1] -= 1; if (this.keys.d) move[1] += 1;

					if (this.keys.e) this.camera.position[1] -= this.camera.speed.position;
					if (this.keys.q) this.camera.position[1] += this.camera.speed.position;

					if (move[0]) { // forward/backwards
						this.camera.position[0] -= 
							Math.cos(this.camera.rotation[0]+Math.PI/2)*
							this.camera.speed.position*move[0];
						this.camera.position[2] += 
							Math.sin(this.camera.rotation[0]+Math.PI/2)*
							this.camera.speed.position*move[0];
					}

					if (move[1]) {
						this.camera.position[0] += 
							Math.cos(this.camera.rotation[0])*
							this.camera.speed.position*move[1];
						this.camera.position[2] -= 
							Math.sin(this.camera.rotation[0])*
							this.camera.speed.position*move[1];
					}

					this.draw();
					window.requestAnimationFrame(this.update.bind(this));
				}

				this.init = function() {
					this.canvas.width = window.innerWidth;
					this.canvas.height = window.innerHeight;
					this.image = this.ctx.createImageData(this.canvas.width, this.canvas.height);

					args.element.appendChild(this.canvas);
					this.canvas.focus();

					this.renderQueue.push(
						this.plane([0, 0, 0], 1),
						this.obj(document.getElementById("spaceship").innerHTML, 0.1)
					);

					window.requestAnimationFrame(this.update.bind(this));
				}

				// canvas things
				this.canvas.addEventListener("keydown", function(e) {
					switch(e.code) {
						case "KeyW": this.keys.w = true; break;
						case "KeyA": this.keys.a = true; break;
						case "KeyS": this.keys.s = true; break;
						case "KeyD": this.keys.d = true; break;

						case "KeyQ": this.keys.q = true; break;
						case "KeyE": this.keys.e = true; break;
					}
				}.bind(this));

				this.canvas.addEventListener("keyup", function(e) {
					switch(e.code) {
						case "KeyW": this.keys.w = false; break;
						case "KeyA": this.keys.a = false; break;
						case "KeyS": this.keys.s = false; break;
						case "KeyD": this.keys.d = false; break;

						case "KeyQ": this.keys.q = false; break;
						case "KeyE": this.keys.e = false; break;
					}
				}.bind(this));

				this.canvas.addEventListener("mousemove", function(e) {
					if (document.pointerLockElement != this.canvas) return;

					this.camera.rotation[0] -= e.movementX*this.camera.speed.rotation;
					this.camera.rotation[1] -= e.movementY*this.camera.speed.rotation;

					if (this.camera.rotation[1] < -Math.PI/2) this.camera.rotation[1] = -Math.PI/2;
					if (this.camera.rotation[1] > Math.PI/2) this.camera.rotation[1] = Math.PI/2;
				}.bind(this));

				this.canvas.addEventListener("click", function(e) {
					this.canvas.requestPointerLock()
				}.bind(this));
			}

			var myGame = new Game();
			myGame.init();
		</script>
	</body>
</html>